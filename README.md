# CyberSecurity2024_IV

## Command

- [netcat](.docs/netcat.md)
- [curl](./docs/curl.md)
- [command](./docs/commands.md)

## Chapter 1

### 1-1 ハッキングラボとは

重要度 ☆☆

ハッキングラボの形態，ケース 2 を使う

### 1-2 本書を読むにあたって

重要度 ☆

前提知識に Linux の基本的なコマンドが操作できることを確認

### 1-3 前作との違い

重要度 ☆

環境構築を減らし，ハンズオンの量を多くした

### 1-4 なぜハッキングラボを作るのか

重要度 ☆☆

ハッキングラボを構築でき，ハッキングのスキルを身につける

### 1-5 本書の心構え

重要度 ☆☆

習うより慣れろ方式，理論を学ぶ場合は他の本と併読

### 1-6 本書におけるハッキングラボ

重要度 ☆☆

仮想マシンを活用せよ，仮想マシンなら新規削除がかんたんに出来
外部に影響を与える影響を与えるリスクを避けられる

仮想 2 台を用いるのでメモリはある程度(8G)以上ほしい

## Chapter2 仮想環境によるハッキングラボの構築

### 2-1 ハッキングを学ぶ方法は色々

重要度 ☆☆

- 本(日本語の書籍は少ない)
- 動画コンテンツ
- Web ページ
- 勉強会(沖縄にもいくつかのグループがある)
- CTF(重要)

VulnHub および Metaspoittable

### 2-2 仮想化とは

#### 仮想化ソフト分類

重要度 ☆☆☆

- ホスト OS 型(VirtualBox など，個人で使う)
- コンテナ型(Docker など，個人で使う)
- ハイパーバイザ型(ネットワークのお仕事はこれを使う)

### 2-3 ハッキングラボで VirtualBox を採用する理由

重要度 ☆☆☆

Host と Guest の関係を知り，IP アドレスを抑える

### 2-4 VirtualBox のインストール

重要度 ☆☆

Linux では APT でインストールできる，もちろん公式のインストーラからでも可

### 2-5 VirtualBox の基本設定

重要度 ☆☆

- Extension Pack のインストール

### 2-6 攻撃用 OS としての KaliLinux と ParrotOS

重要度 ☆☆

Linux ディストリビューションとは何かを知り，攻撃用端末向けの Linux を知る

### 2-7 VirtualBox に ParrotOS をインストールする

重要度 ☆☆☆

エキスパートモードを使用して設定するべきところを理解する

- HardDisk 容量
- メモリ& CPU&ヴィデオメモリの設定

### 2-8 初めての ParrotOS

重要度 ☆☆

まずは VirtualBox の Host キー理解とパッケージを APT でアップグレードできればよい

#### OS のセキュリティ機構

重要度 ☆☆☆

- SELinux(disable)
- AppArmer(実験のみ)
- iptable & ufw(disable)

### 2-9 ParrotOS のネットワーク設定

#### VirtualBox におけるネットワークの種類

重要度 ☆☆☆

##### 重要ポイント

- VirtualBox でのネットワークのセッティングができるようにする
- ParrotOS の IP セッティングができるようにする

##### ネットワーク基礎を速習する(P102)

重要度 ☆☆☆

それぞれ説明できること

##### VirtualBox におけるネットワークの種類(P109)

重要度 ☆☆☆

VirtualBox は様々なネットワークをサポートしているが，Nat と HostOnly をつかう

##### 本書における ParrotOS のネットワーク構成(P115)

重要度 ☆☆

教科書では Nat と HostOnly を使い分けているが，両方バインドしていてもよい

##### ParrotOS を HostOnlyNetwork に接続するよう設定する(P117)

重要度 ☆☆☆

静的アドレスの設定の仕方はいくつかあるが，旧来のやり方と NetworkManager 経由のやりかたとを理解して設定できるようにする，GUI は特に覚える必要はない

## Chapter3 ParrotOS で遊ぼう

### 3-1 ParrotOS 内を探検する(p130)

重要度 ☆☆☆

FHS(Filesystem Hiearchy Standard) という標準があり，Linux の各ディストリビューションはそれに従っている。各ディレクトリがそれぞれどういうファイルを格納する役割を持っているかを知る。

### 3-2 more コマンドと less コマンド(p138)

重要度 ☆☆☆

more も less もページャーの一種であり，less は使用頻度が高いのでキーバインドを覚えておく必要がある。

### 3-3 ファイルの探し方

重要度 ☆☆☆

Linux での検索はまず locate コマンドとワイルドカード及び簡単な正規表現をおぼえて次に find コマンドを使えるようにすること，GUI は特に必要ない。

### 3-4 man を活用する(p151)

重要度 ☆☆☆☆

新しいコマンドがでたらまず man をみるクセをつけよう，ふだんから man に目をとおして置くことでオプションが使えるようになる。

### 3-5 ファイル操作とパーミッション(162)

#### ファイルを扱う基本コマンド(p162)

重要度 ☆☆☆☆

ファイルを扱う基本コマンドは基本なので rmdir と more 以外は皆普段遣いである。

#### ユーザーの種類(p163)

重要度 ☆☆☆☆

root, system, 一般ユーザーの役割を知りなぜ別れているかを説明できるようにせよ

下記のコマンドがどのような情報を返すか確認し man からオプションを確認して試してみよ

- whoami
- id
- groups

#### ユーザーとグループの情報ファイル(p167)

重要度 ☆☆☆

- /etc/passwd
- /etc/shadow
- /etc/group

#### ファイルの属性情報(p171 - p180 )

重要度 ☆☆☆☆

ファイル種別とユーザ，グループ，パーミッションを理解し変更できるようにしよう

- パーミッションの変更はオクタルもシンボリックもどちらも使えるように
- デフォルトパーミッションと umask の関係を理解しよう
- ファイルの所有者やグループを変更できるようにしよう

### 3-6 テキスト編集をマスターする(p181-p187)

重要度 ☆☆☆☆

vi をまともに使えるようになろう，その他のエディタはお試しくらいでよい

### 3-7 ParrotOS におけるインストールテクニック(p188 - p206)

重要度 ☆☆☆

ディストリビューションによってパッケージ管理は違うが，Ubuntu も ParrotOS も同じ Debian けいなので`dpkg`と`apt`が使える，何が違うのかを理解すること。
また OS 以外でもパッケージ管理の仕組みはたくさん出てくるので(pip, npm 等)パ ッケージ管理でなにができるのかを理解すること，ここでも GUI のパッケージ管理(Synaptic)は特に覚える必要はない。

### 3-8 プロセスを理解する(p206)

重要度 ☆☆☆☆☆

このセクションは非常に重要なので，何度もサンプルを実行して理解をすること

#### プログラム，ソフトウェア，アプリケーション(p206)

重要度 ☆☆

コンピューティングの中心にプログラムがあることを理解する，タイトルの単語以外にもスレッド，プロセス，ジョブ，バッチなどの用語があるがすべてプログラムの一形態に過ぎないことを理解する

#### プロセスの状態を確認する(p207)

重要度 ☆☆☆☆☆

プロセスの状態遷移を知り，表示される出力項目の内容がわかり基本的な ps コマンドのオプションが使えるようになろう。

- R 実行(可能)状態(running, ready)
- T 停止状態(terminate)
- S 割り込み可能停止状態(sleep)
- Z ゾンビ状態(zombi)
- PID(proccess id)
- TTY(teletypewriter)
- CMD(command)

#### プロセスを追跡する(p213)

重要度 ☆☆☆☆

top コマンドの見方と覚え対話コマンドを試してみよう。

#### プロセスには親子関係がある(p215)

重要度 ☆☆☆

UNIX のブートストラップから，どのようにプロセスが管理されているかは後々重要になるが今の段階ではプロセスの親子関係にあることを理解できていれば良い。

#### プロセスを停止・終了する(p219)

重要度 ☆☆☆☆

kill コマンドを使ってシグナルを送信する方法を覚え，下記のシグナルは覚えよう
シグナル名は単に番号のエイリアスである，つまり `$ kill -KILL PID` は `$ kill -9 PID` と同等の効力を持つ。SIGTERM と SIGKILL の違いは覚えよう。
ドレスを割り当てて良い。どちらかというと固定 I

- 1 HUP
- 9 KILL
- 15 TERM
- 20 TSTP

#### ジョブコントロールでプロセスを操る(p223)

重要度 ☆☆☆☆

p224 の図を理解して，状態遷移を行えるようにしよう

- jobs
- % $JOBID
- bg
- fg
- ^Z
- &

### 3-9 シェル変数と環境変数(p229)

重要度 ☆☆☆

シェル変数と環境変数の違いを理解してどちらも定義できるようにする

シェル変数の定義は `変数名=値` (＝の前後に空白を入れない)，シェル変数は子シェルに引き継がれない，`echo $変数名` で参照できる

環境変数の定義は ` export 変数名=値` 環境変数は子シェルに引き継がれる，環境
変数の一覧を見るには `printenv` を使う

#### コマンドパスを含む環境変数 PATH(p236)

重要度 ☆☆☆

PATH とは何か，なぜ便利なのかを説明できること。また$PATH に PATH の追加ができるようになること。

#### ビルトインコマンド(p239)

重要度 ☆☆

UNIX のコマンドは外部コマンド(プログラムが bin などのディレクトリにある)と内部コマンド(ビルトインコマンド)がある。以下のコマンドを用いてコマンドの種別や場所を確認しよう

- type
- which
- whereis

## Chapter4 仮想マシンで習得するサーバー侵入(p245)

### 4-1 実験のコンセプト

2 部で行うことの説明，著者がどういう考えのもとに実験をさせるのかの説明，一通り読むこと

### 4-2 VulnHub について(p247)

VlunHub の説明，ハッキングの練習台となる脆弱マシンが多数ある。あとに出てくる Metasploitable もそういった脆弱性マシンでありこれらを攻略することによってスキルをあげることができる。

#### 4-3 第 2 部におけるハッキングラボの構成

攻撃用端末として ParrotOS を使い HostOnly の環境で脆弱マシンをハッキングする。
本書では DHCP をもちいて，192.168.56.0/24 ネットワーク上に末尾 101 を Parrot(攻撃用)に割り振り 102 を脆弱性マシンに使用する想定であるが無論通信ができれば好きなアドレスを割り当てて良い。どちらかというと固定 I P のほうが望ましい

#### 4-4 サーバー侵入の基本的な流れ

実験を行う中で，下記のどのフェーズにいるのかを考えながら，各フェーズで使われるツールやその使用方法を学んでいく。2 年時には教科書を見ないで攻撃ができるように何度も繰り返して練習すること。

1. 選定フェーズ
2. 偵察・調査フェーズ
3. 初期攻撃フェーズ
4. 侵入経路確率フェーズ
5. 権限昇格フェーズ
6. 内部偵察フェーズ
7. 完全掌握フェーズ
8. 後始末フェーズ

## 第 2 部実験編

### EXPERIMENT #01 Potato のハッキング(p262)

#### 事前学習

- su コマンドと sudo コマンドの使い方，sudoers ファイルの設定方法
- ping(ICMP)の仕組み
- IP TCP UDP ICMP といった(L3, L4 の)基本プロトコル
- Wireshark(tcpdump)の表示フィルターとキャプチャーフィルター
- 仮想マシンのクローン
- netcat
- バインドシェルとリバースシェル

#### ハッキング技術

- SCAN(スキャン)
  - netdiscover(同一ネットワーク内の PC・ルータ等ネットワークに接続されたデバイスを調査するコマンド)
  - Nmap(ネットワーク調査およびセキュリティ監査を行うためのオープンソースのツール ネットワーク上でどのようなホストか利用可能になっているか，これらのホストが提供しているサービス(アプリケーション名とバージョン)は何か、ホストが実行している OS(OS 名とバージョン)は何か，どのような種類のパケットフィルタ/ファイアウォールが使用されているかなどを調査することができる)
  - Gobuster(ペネトレーションテストや. Web アプリケーションのセキュリティ診断で使用されるオープンソースツールです。Web サイトや Web アプリケーションの隠しディレクトリやファイル検索が可能。ハッキングの際に，隠しページや他にアクセス出来るページを検索する事ができる)
- INVASION(侵入)
  - AnonymousFTP(TCP/IP ネットワーク上でファイルの送受信を行う FTP を、誰でも匿名で自由に利用できるようにする仕組み)
  - Directory traversal(WEB サイトやアプリケーションにおいて，管理者が公開する意思のないファイルや情報に対し，攻撃者が不正にアクセスするサイバー攻撃手法)
  - SSH(Secure Shell の略称で，リモートコンピュータと暗号化して通信するためのプロトコルやアプリケーション)
- AUTHENTICATION(認証)
  - Burp(ペネトレーションテストなどで利用されるローカルプロキシツール PC と Web サーバの通信内容を確認しパラメータを修正，送信などができる)
  - John the ripper(オープンソースのパスワードクラッキングツール，ハッシュ化されたパスワードから、元のパスワードを特定する)
- PRIVILEGE(権限)
  - sudo -l(sudoers ファイルを見る)
  - /bin/nice(processs の実行優先順序を変更するコマンド)
